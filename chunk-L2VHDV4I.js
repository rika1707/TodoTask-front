import{$ as I,A as y,B as O,D as j,K as B,L as S,N as _,O as V,S as z,U as q,V as P,Z as H,_ as $,a as x,aa as p,ba as M,ca as N,da as w,e as G,ea as E,f as b,fa as U,ga as J,ha as R,i as u,ia as L,j as a,ja as K,k as h,ka as Q,l as F,la as W,ma as X,n as m,na as Y,o as l,oa as Z,pa as ee,qa as te,ra as oe,s as r,sa as re,t as o,ta as ne,u as c,ua as ie,v as g,va as T,w as d,z as s}from"./chunk-AJP3TOXR.js";var C=class e{_hhtp=u(V);loginUrl=`${P.API_URL}/login`;userUrl=`${P.API_URL}/users`;isAuthenticated(){return!!localStorage.getItem("user")}login({userName:n,password:t}){return this._hhtp.post(this.loginUrl,{userName:n,password:t})}createUser(n){return this._hhtp.post(this.userUrl,n)}static \u0275fac=function(t){return new(t||e)};static \u0275prov=G({token:e,factory:e.\u0275fac,providedIn:"root"})};var pe=e=>({"btn-accept":e});function ue(e,n){e&1&&(r(0,"span",16),s(1,"El Usuario es obligatorio"),o())}function de(e,n){e&1&&(r(0,"span",16),s(1,"Debe tener al menos 3 caracteres"),o())}function ce(e,n){if(e&1&&(r(0,"p"),m(1,ue,2,0,"span",10)(2,de,2,0,"span",10),o()),e&2){let t=d();a(),l("ngIf",t.userFormControls.userName.errors==null?null:t.userFormControls.userName.errors.required),a(),l("ngIf",t.userFormControls.userName.errors==null?null:t.userFormControls.userName.errors.minlength)}}function fe(e,n){e&1&&(r(0,"span",16),s(1,"El nombre es obligatorio"),o())}function ge(e,n){e&1&&(r(0,"span",16),s(1,"Debe tener al menos 3 caracteres"),o())}function _e(e,n){if(e&1&&(r(0,"p"),m(1,fe,2,0,"span",10)(2,ge,2,0,"span",10),o()),e&2){let t=d();a(),l("ngIf",t.userFormControls.name.errors==null?null:t.userFormControls.name.errors.required),a(),l("ngIf",t.userFormControls.name.errors==null?null:t.userFormControls.name.errors.minlength)}}function Ce(e,n){e&1&&(r(0,"span",16),s(1,"El nombre es obligatorio"),o())}function ve(e,n){e&1&&(r(0,"span",16),s(1,"Debe tener al menos 3 caracteres"),o())}function xe(e,n){if(e&1&&(r(0,"p"),m(1,Ce,2,0,"span",10)(2,ve,2,0,"span",10),o()),e&2){let t=d();a(),l("ngIf",t.userFormControls.lastName.errors==null?null:t.userFormControls.lastName.errors.required),a(),l("ngIf",t.userFormControls.lastName.errors==null?null:t.userFormControls.lastName.errors.minlength)}}function be(e,n){e&1&&(r(0,"span",16),s(1,"La contrase\xF1a es obligatoria"),o())}function he(e,n){if(e&1&&(r(0,"p"),m(1,be,2,0,"span",10),o()),e&2){let t=d();a(),l("ngIf",t.userFormControls.password.errors==null?null:t.userFormControls.password.errors.required)}}function Fe(e,n){e&1&&(r(0,"span",16),s(1,"La contrase\xF1a es obligatoria"),o())}function ye(e,n){if(e&1&&(r(0,"p"),m(1,Fe,2,0,"span",10),o()),e&2){let t=d();a(),l("ngIf",t.userFormControls.confirmPassword.errors==null?null:t.userFormControls.confirmPassword.errors.required)}}function Se(e,n){e&1&&(r(0,"span",16),s(1,"La contrase\xF1a no coincide."),o())}function Ie(e,n){e&1&&(r(0,"span",16),s(1,"El nombre es obligatorio"),o())}function Me(e,n){e&1&&(r(0,"span",16),s(1,"Formato de correo no valido"),o())}function Ne(e,n){if(e&1&&(r(0,"p"),m(1,Ie,2,0,"span",10)(2,Me,2,0,"span",10),o()),e&2){let t=d();a(),l("ngIf",t.userFormControls.email.errors==null?null:t.userFormControls.email.errors.required),a(),l("ngIf",t.userFormControls.email.errors==null?null:t.userFormControls.email.errors.email)}}var D=class e{_modalSvc=u(T);_fb=u(R);_loginSvc=u(C);userForm;_mat_dialog=u(K);message;_snackBar=u(ie);_buildForm(){this.userForm=this._fb.nonNullable.group({userName:["",[p.required,p.maxLength(50)]],name:["",[p.required,p.maxLength(50)]],lastName:["",[p.required,p.maxLength(50)]],password:["",[p.required,p.maxLength(10)]],confirmPassword:["",[p.required]],email:["",[p.required,p.email,p.maxLength(100)]]},{validators:this.passwordsMatch})}ngOnInit(){this._buildForm()}onSubmitUser(){return x(this,null,function*(){this._loginSvc.createUser(this.userForm.value).subscribe({next:n=>{this.message=n,this._snackBar.open(this.message.message,"",{duration:2e3,horizontalPosition:"end",verticalPosition:"top"}),this.userForm.reset()},error:n=>{console.error(n)}}),this.userForm.markAllAsTouched(),this._modalSvc.closeModal()})}getTitle(){return this._mat_dialog.data?"Editar":"Agregar"}onNoClick(){this._modalSvc.closeModal()}get userFormControls(){return this.userForm.controls}passwordsMatch(n){let t=n,i=t.get("password")?.value,f=t.get("confirmPassword")?.value;return console.log(f),i===f?null:{mismatch:!0}}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=h({type:e,selectors:[["app-modal-register-user"]],decls:48,vars:15,consts:[["mat-dialog-title",""],[3,"submit","formGroup"],["mat-dialog-content",""],[1,"row"],[4,"ngIf"],["appearance","fill",1,"w-full"],["matInput","","type","text","formControlName","userName"],["matInput","","type","text","formControlName","name"],["matInput","","type","text","formControlName","lastName"],["matInput","","type","text","formControlName","password"],["class","text-red-500",4,"ngIf"],["matInput","","type","text","formControlName","confirmPassword"],["matInput","","type","text","formControlName","email"],["mat-dialog-actions",""],["mat-raised-button","",3,"click","mat-dialog-close"],["mat-raised-button","","color","primary","type","submit",3,"disabled","ngClass"],[1,"text-red-500"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"h1"),s(2),o()(),r(3,"form",1),g("submit",function(){return i.onSubmitUser()}),r(4,"div",2)(5,"div",3),m(6,ce,3,2,"p",4),r(7,"mat-form-field",5)(8,"mat-label"),s(9," Usuario "),o(),c(10,"input",6),o()(),m(11,_e,3,2,"p",4),r(12,"div",3)(13,"mat-form-field",5)(14,"mat-label"),s(15," Nombre "),o(),c(16,"input",7),o()(),m(17,xe,3,2,"p",4),r(18,"div",3)(19,"mat-form-field",5)(20,"mat-label"),s(21," Apellidos "),o(),c(22,"input",8),o()(),m(23,he,2,1,"p",4),r(24,"div",3)(25,"mat-form-field",5)(26,"mat-label"),s(27," Contrase\xF1a "),o(),c(28,"input",9),o()(),m(29,ye,2,1,"p",4),r(30,"p"),m(31,Se,2,0,"span",10),o(),r(32,"div",3)(33,"mat-form-field",5)(34,"mat-label"),s(35," Confirmar contase\xF1a "),o(),c(36,"input",11),o()(),m(37,Ne,3,2,"p",4),r(38,"div",3)(39,"mat-form-field",5)(40,"mat-label"),s(41," Correo "),o(),c(42,"input",12),o()()(),r(43,"div",13)(44,"button",14),g("click",function(){return i.onNoClick()}),s(45,"Cancelar"),o(),r(46,"button",15),s(47),o()()()),t&2&&(a(2),O("",i.getTitle()," Usuario"),a(),l("formGroup",i.userForm),a(3),l("ngIf",i.userFormControls.userName&&i.userFormControls.userName.invalid&&i.userFormControls.userName.touched),a(5),l("ngIf",i.userFormControls.name&&i.userFormControls.name.invalid&&i.userFormControls.name.touched),a(6),l("ngIf",i.userFormControls.lastName&&i.userFormControls.lastName.invalid&&i.userFormControls.lastName.touched),a(6),l("ngIf",i.userFormControls.password&&i.userFormControls.password.invalid&&i.userFormControls.password.touched),a(6),l("ngIf",i.userFormControls.confirmPassword&&i.userFormControls.confirmPassword.invalid&&i.userFormControls.confirmPassword.touched),a(2),l("ngIf",i.userForm.hasError("mismatch")&&i.userFormControls.confirmPassword.touched),a(6),l("ngIf",i.userFormControls.email&&i.userFormControls.email.invalid&&i.userFormControls.email.touched),a(7),l("mat-dialog-close",!1),a(2),l("disabled",!i.userForm.valid)("ngClass",j(13,pe,i.userForm.valid)),a(),y(i.getTitle()))},dependencies:[L,w,I,M,N,E,U,_,B,S,ee,ne,re,te,oe,Z,Q,W,Y,X,$,H],styles:["button.btn-accept[_ngcontent-%COMP%]{background-color:#00f;color:#fff}"],changeDetection:0})};function we(e,n){if(e&1&&(r(0,"p",17)(1,"span"),s(2),o()()),e&2){let t=d();a(2),y(t.user.message)}}function Ee(e,n){e&1&&(r(0,"span",19),s(1,"El Usuario es obligatorio"),o())}function Ue(e,n){e&1&&(r(0,"span",19),s(1,"Debe tener al menos 3 caracteres"),o())}function Re(e,n){if(e&1&&(r(0,"p"),m(1,Ee,2,0,"span",18)(2,Ue,2,0,"span",18),o()),e&2){let t=d();a(),l("ngIf",t.userName.errors==null?null:t.userName.errors.required),a(),l("ngIf",t.userName.errors==null?null:t.userName.errors.minlength)}}function Le(e,n){e&1&&(r(0,"span",19),s(1,"La contrasenia es obligatoria"),o())}function Te(e,n){if(e&1&&(r(0,"p"),m(1,Le,2,0,"span",18),o()),e&2){let t=d();a(),l("ngIf",t.password==null||t.password.errors==null?null:t.password.errors.required)}}var v=class e{loginForm;_fb=u(R);_loginSvc=u(C);_modalSvc=u(T);_route=u(z);user;errorMessage;ngOnInit(){this._buildForm()}_buildForm(){this.loginForm=this._fb.nonNullable.group({userName:["",[p.required,p.maxLength(50),p.minLength(4)]],password:["",[p.required,p.maxLength(20)]]})}loginSesion(){return x(this,null,function*(){this.loginForm.valid&&this._loginSvc.login(this.loginForm.value).subscribe({next:n=>{this.user=n,localStorage.setItem("user",JSON.stringify(this.user)),this.loginForm.reset(),n.exito&&this._route.navigate(["tasks"])},error:n=>{console.log(n.error.message),this.user=n.error}}),this.loginForm.markAllAsTouched()})}get userName(){return this.loginForm.get("userName")}get password(){return this.loginForm.get("password")}registerUser(){this._modalSvc.openModal(D)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=h({type:e,selectors:[["app-login"]],decls:28,vars:4,consts:[[1,"flex","min-h-full","flex-col","justify-center","items-center","px-6","py-12","lg:px-8","bg-slate-800"],[1,"bg-slate-600","w-120","px-6","py-1","rounded"],[1,"sm:mx-auto","sm:w-full","sm:max-w-sm"],[1,"mt-10","text-center","text-2xl/9","font-bold","tracking-tight","text-white"],[1,"mt-10","sm:mx-auto","sm:w-full","sm:max-w-sm"],["class"," bg-red-200 text-red-500  py-2 px-4 mb-2",4,"ngIf"],[1,"space-y-6",3,"submit","formGroup"],["for","userName",1,"block","text-sm/6","font-medium","text-white"],[1,"mt-2"],["type","text","name","userName","id","userName","autocomplete","userName","required","","formControlName","userName",1,"block","w-full","rounded-md","bg-white","px-3","py-1.5","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-indigo-600","sm:text-sm/6"],[4,"ngIf"],[1,"flex","items-center","justify-between"],["for","password",1,"block","text-sm/6","font-medium","text-white"],["type","password","name","password","id","password","autocomplete","current-password","required","","formControlName","password",1,"block","w-full","rounded-md","bg-white","px-3","py-1.5","text-base","text-gray-900","outline-1","-outline-offset-1","outline-gray-300","placeholder:text-gray-400","focus:outline-2","focus:-outline-offset-2","focus:outline-indigo-600","sm:text-sm/6"],["type","submit",1,"flex","w-full","justify-center","rounded-md","bg-indigo-600","px-3","py-1.5","text-sm/6","font-semibold","text-white","shadow-xs","hover:bg-indigo-500","focus-visible:outline-2","focus-visible:outline-offset-2","focus-visible:outline-indigo-600"],[1,"mt-10","text-center","text-sm/6","text-gray-300","pb-10"],[1,"font-semibold","text-indigo-400","hover:text-indigo-500","cursor-pointer",3,"click"],[1,"bg-red-200","text-red-500","py-2","px-4","mb-2"],["class","text-red-500",4,"ngIf"],[1,"text-red-500"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),s(4,"Iniciar Sesi\xF3n"),o()(),r(5,"div",4),m(6,we,3,1,"p",5),r(7,"form",6),g("submit",function(){return i.loginSesion()}),r(8,"div")(9,"label",7),s(10,"Usuario"),o(),r(11,"div",8),c(12,"input",9),o(),m(13,Re,3,2,"p",10),o(),r(14,"div")(15,"div",11)(16,"label",12),s(17,"Contrase\xF1a"),o()(),r(18,"div",8),c(19,"input",13),o(),m(20,Te,2,1,"p",10),o(),r(21,"div")(22,"button",14),s(23,"Login"),o()()(),r(24,"p",15),s(25," No tienes cuenta? "),r(26,"span",16),g("click",function(){return i.registerUser()}),s(27,"Registrate"),o()()()()()),t&2&&(a(6),l("ngIf",i.user&&!i.user.exito),a(),l("formGroup",i.loginForm),a(6),l("ngIf",i.userName&&i.userName.invalid&&i.userName.touched),a(7),l("ngIf",i.password&&(i.password==null?null:i.password.invalid)&&(i.password==null?null:i.password.touched)))},dependencies:[L,w,I,M,N,J,E,U,_,S],styles:["html[_ngcontent-%COMP%]{--background-color: #ffffff;--text-color: #000000}@media (prefers-color-scheme: dark){html[_ngcontent-%COMP%]{--background-color: #121212;--text-color: #ffffff}}body[_ngcontent-%COMP%]{background-color:var(--background-color);color:var(--text-color);transition:all .3s ease-in-out}"]})};var ke=[{path:"",component:v}],A=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=F({type:e});static \u0275inj=b({imports:[q.forChild(ke),q]})};var ae=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=F({type:e});static \u0275inj=b({imports:[v,_,A]})};export{C as a,ae as b};
